<!DOCTYPE html>
<html>
  <head>
  <link href="http://sighingnow.github.io" rel="profile">
  <meta charset="UTF-8">
  
  <meta name="description" content="Sighingnow's homepage using Jekyll Metro">
  
	<meta name="author" content="Sighingnow">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Scala 公开课笔记 &middot; Sighingnow
    
  </title>

  
  <!-- Twitter Card data -->
  <meta name="twitter:card" value="summary">
  <!-- Open Graph data -->
  <meta property="og:title" content="Scala 公开课笔记" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/scala_coursera_notes.html" />
  <meta property="og:description" content="" />
  

  <!-- CSS -->
  <link rel="stylesheet" href="http://sighingnow.github.io/assets/css/bootstrap.css">
  <link rel="stylesheet" href="http://sighingnow.github.io/assets/css/app.css">
  <link rel="stylesheet" href="http://sighingnow.github.io/assets/css/pandoc-tango.css">

  <script src="/assets/js/all.js"></script>
  <script src="/assets/js/app.js"></script>
  <script src="/assets/js/jekyll-search.js"></script>


  

  

  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="128x128" href="http://sighingnow.github.io/assets/images/favicon-128.png">
  <link rel="shortcut icon" href="http://sighingnow.github.io/assets/images/favicon-16.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
</head>

  <body>
                  <div class="navbar navbar-default visible-xs">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Sighingnow</a>
                </div>
                <div class="navbar-collapse collapse navbar-responsive-collapse">
                    <ul class="nav navbar-nav">
                        
                          <li>
                            <a href="/about/">About</a>
                          </li>
                        
                          <li>
                            <a href="/resume/">Resume</a>
                          </li>
                        
                          <li>
                            <a href="/blog/">Blog</a>
                          </li>
                        
                          <li>
                            <a href="/archive/">Archive</a>
                          </li>
                        
                          <li>
                            <a href="/tags/">Tags</a>
                          </li>
                        
                    </ul>
                </div>
            </div>

      <div class="container-fluid">
  <div class="row">
    <div class="hidden-xs col-md-2 col-sm-3 blue sidebar">
      <aside>
  <div class="row">
    <div class="col-md-12">
    <br/>
        
        <h1 class="text-center" style="margin-top:0px"><a href="/blog" class="icon icon-back"></a></h1>
        
    </div>
  </div>
  <div class="row">
      <div class="col-md-12">
        <ul class="left-nav">
        
          
          
            <li class="left-nav-item">
              <a href="/about/">About</a>
            </li>
          
        
          
          
            <li class="left-nav-item">
              <a href="/resume/">Resume</a>
            </li>
          
        
          
          
            <li class="left-nav-item left-nav-selected">Blog</a>
          
        
          
          
            <li class="left-nav-item">
              <a href="/archive/">Archive</a>
            </li>
          
        
          
          
            <li class="left-nav-item">
              <a href="/tags/">Tags</a>
            </li>
          
        
        </ul>
    </div>
  </div>
</aside>

    </div> <!-- Side column -->
    <div class="col-md-10 col-sm-9 col-md-offset-2 col-sm-offset-3">
      <article class="col-md-12 col-xs-12 justified">
        <h1 class="post-title">Scala 公开课笔记</h1>
        <div class="publish-tag">
          <span class="fa fa-calendar"></span>&nbsp;Published On July 31, 2015
        </div>
        <p>Coursera上的瑞士洛桑理工大学Scala函数式编程原理(Functional Programming Principles in Scala)课程笔记。</p>
<p>课程链接：<a href="https://class.coursera.org/progfun-005">Functional Programming Principles in Scala</a></p>
<h2 id="getting-started">Getting Started</h2>
<p>Scala开发环境配置相关的几点经验：</p>
<ol type="1">
<li>解决Scala编译太慢的问题：使用sbt构建，保持一个运行sbt的console。也就是说，让一个JVM常驻内存，可以显著提升编译效率。</li>
<li><p>sbt解决依赖的过程中出现sha1 error: 在build.sbt中增加如下内容：</p>
<pre><code>checksums in update := Nil</code></pre>
<p>或者在sbtconfig.txt中增加如下内容，禁用全局sha1 check:</p>
<pre><code>-Dsbt.ivy.checksums=&quot;&quot; # 默认值为&quot;md5, sha1&quot;</code></pre></li>
<li><p>自定义sbt的缓存位置: 在sbtconfig.txt中增加如下内容：</p>
<pre><code>-Dsbt.ivy.home=d:/Java/sbt/
-Dsbt.boot.directory=d:/Java/sbt/boot/</code></pre></li>
</ol>
<!--more-->
<h2 id="week-1-functions-evaluations">Week 1: Functions &amp; Evaluations</h2>
<ol type="1">
<li><p>三种编程范式(Programming Paradigms)</p>
<ul>
<li>impreative programming</li>
<li>functional programming</li>
<li>logic programming</li>
</ul></li>
<li><p>命令式编程受限于冯·诺依曼(Von Neumann)体系结构。</p></li>
<li><p>不可变类型理论(Theories without Mutation)</p></li>
<li><p>三个要点：将精力集中于定义运算符，最小化状态改变，将运算符视为函数。</p></li>
<li><p>REPL：Read-Eval-Print Loop</p></li>
</ol>
<p>求值过程：从左至右求值，如果有函数，先从左至右对参数求值，再将参数的值带入。</p>
<p>带入模型(The substitution model)是在lambda演算中形式化，是Functional Programming的基础(foundation)。</p>
<p>终止问题：</p>
<pre><code>def loop: Int = loop</code></pre>
<p>这个求值过程永远不会终止。</p>
<blockquote>
<p>The interpreter reduces function arguments to values before rewriting the function application.</p>
</blockquote>
<ol start="6" type="1">
<li>两种求值策略(evaluation strategy)：Call-by-Name, Call-by-Value</li>
</ol>
<p>求值策略与Subsitution Model.</p>
<p>Call-by-value has the advantage that it evaluates every function argument only once.</p>
<p>Call-by-name has the advantage that a function argument is not evaluated if the corresponding parameter is unused in the evaluation of the function body.</p>
<p>由于两种求值策略的区别，某些求值序列可能在一种策略下会终止，在另外一种求值策略下并不会终止。</p>
<p>例如：</p>
<pre><code>def loop(): Int = loop
def func(a:Int, b:Int) = 1</code></pre>
<p>求值:</p>
<pre><code>func(1, loop)</code></pre>
<p>如果是CBV，参数的求值过程不会终止，而如果是CBN，只有在用到参数时才会对参数求值，因此这个求值过程会直接返回1，而不会对参数loop求值。</p>
<p>只有在以下情况下两种策略会返回相同的值：</p>
<blockquote>
<p>the reduced expression consists of pure functions, and both evaluations terminate.</p>
</blockquote>
<p>在Scala中，一般都是Call-by-Value, 如果函数的参数用<code>=&gt;</code>来表示类型，那么该参数会是Call-by-Name。</p>
<p>例如：</p>
<pre><code>def func(x: Int, y: =&gt; Int) = 1</code></pre>
<p>对于这个函数定义，x是CBV，而y是CBN。<code>func(1, loop)</code>能够终止，因为并不需要对loop进行求值。</p>
<ol start="7" type="1">
<li>语句块和词法作用域(Blocks and Lexical Scope)</li>
</ol>
<p>Scala允许函数嵌套。例如：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="co">// Square roots with Newton’s method</span>
<span class="kw">def</span> <span class="fu">sqrt</span>(x: Double) = {
  <span class="kw">def</span> <span class="fu">sqrtIter</span>(guess: Double, x: Double): Double =
    <span class="kw">if</span> (<span class="fu">isGoodEnough</span>(guess, x)) guess
    <span class="kw">else</span> <span class="fu">sqrtIter</span>(<span class="fu">improve</span>(guess, x), x)
  <span class="kw">def</span> <span class="fu">improve</span>(guess: Double, x: Double) =
    (guess + x / guess) / <span class="dv">2</span>
  <span class="kw">def</span> <span class="fu">isGoodEnough</span>(guess: Double, x: Double) =
    <span class="fu">abs</span>(<span class="fu">square</span>(guess) - x) &lt; <span class="fl">0.001</span>
  <span class="fu">sqrtIter</span>(<span class="fl">1.0</span>, x)
}</code></pre>
<p>Scala中的Block:</p>
<pre class="sourceCode scala"><code class="sourceCode scala">{
  <span class="kw">var</span> x = <span class="fu">f</span>(<span class="dv">3</span>)
  x*x
}</code></pre>
<p>对于Block，Scala中变量和函数的可见性如下：</p>
<blockquote>
<p>The definitions inside a block are only visible from within the block.</p>
</blockquote>
<blockquote>
<p>The definitions inside a block shadow definitions of the same names outside the block.</p>
</blockquote>
<blockquote>
<p>Deﬁnitions of outer blocks are visible inside a block unless they are shadowed.</p>
</blockquote>
<ol start="8" type="1">
<li>尾递归(Tail Recursion)</li>
</ol>
<p>Implementation Consideration: If a function calls itself as its last action, the function’s stack frame can be reused. This is called tail recursion.</p>
<p>在Scala中，只有对当前函数的直接递归调用能够被尾递归优化。使用<code>@tailrec</code>注解表明当前函数存在尾递归。如果对一个不是尾递归实现的函数使用<code>@tailrec</code>注解，将会产生错误。</p>
<pre class="sourceCode scala"><code class="sourceCode scala">@tailrec
<span class="kw">def</span> <span class="fu">gcd</span>(a:Int, b:Int): Int = {
  <span class="kw">if</span> (b == <span class="dv">0</span>) a <span class="kw">else</span> <span class="fu">gcd</span>(b, a % b)
}

<span class="co">// tail recursion version of factorial function.</span>
<span class="kw">def</span> <span class="fu">factorial</span>(n: Int): Int = {
  @tailrec
  <span class="kw">def</span> <span class="fu">factorial_i</span>(acc: Int, n: Int): Int = {
    <span class="kw">if</span>(n == <span class="dv">0</span>) acc
    <span class="kw">else</span> <span class="fu">factorial_i</span>(acc*n, n<span class="dv">-1</span>)
  }
  <span class="fu">factorial_i</span>(<span class="dv">1</span>, n)
}

<span class="co">// tail recursion version of Fibonacci sequence.</span>
<span class="co">// NOTE: need two accumulator.</span>
<span class="kw">def</span> <span class="fu">fibonacci</span>(n: Int, acc_first: Int, acc_second: Int): Int = {
  <span class="kw">if</span>(n == <span class="dv">0</span>) acc_first
  <span class="kw">else</span> <span class="fu">fibonacci</span>(n<span class="dv">-1</span>, acc_second, acc_first + acc_second)
}</code></pre>
<p>有这几个例子可以看到将满足一定条件的普通递归转化为尾递归的基本方法和技巧。</p>
<ol start="9" type="1">
<li>Scala中，函数没有返回值时，默认返回<code>Unit</code>。</li>
</ol>
<h2 id="week-2-higher-order-functions">Week 2: Higher Order Functions</h2>
<ol type="1">
<li>Functional languages treat functions as <em>ﬁrst-class</em> values.</li>
</ol>
<p>在Functional Programming中，函数可以被当成一个参数，也可以作为返回值。</p>
<p>高阶函数的定义：</p>
<blockquote>
<p>Functions that take other functions as parameters or that return functions as results are called higher order functions.</p>
</blockquote>
<p>使用高阶函数的例子：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">sum</span>(f: Int=&gt;Int, a: Int, b: Int) {
  <span class="kw">if</span>(a &gt; <span class="dv">0</span>) <span class="dv">0</span>
  <span class="kw">else</span> <span class="fu">f</span>(a) + <span class="fu">sum</span>(f, a<span class="dv">+1</span>, b)
}

<span class="kw">def</span> <span class="fu">id</span>(x:Int): Int   = x
<span class="kw">def</span> <span class="fu">cube</span>(x:Int): Int = x*x*x
<span class="kw">def</span> <span class="fu">fact</span>(x:Int): Int = <span class="kw">if</span>(x==<span class="dv">1</span>) <span class="dv">1</span> <span class="kw">else</span> x*<span class="fu">fact</span>(x<span class="dv">-1</span>)

<span class="kw">def</span> <span class="fu">sumId</span>(a, b)   = <span class="fu">sum</span>(id, a, b)
<span class="kw">def</span> <span class="fu">sumCube</span>(a, b) = <span class="fu">sum</span>(cube, a, b)
<span class="kw">def</span> <span class="fu">sumFact</span>(a, b) = <span class="fu">sum</span>(fact, a, b)</code></pre>
<ol start="2" type="1">
<li><p>在Scala中，函数也是一种类型。例如<code>Int=&gt;Int</code>表示的就是参数类型为一个<code>Int</code>, 返回值也是<code>Int</code>的函数的类型。</p></li>
<li><p>匿名函数(Anonymous Functions)</p></li>
</ol>
<p>One can therefore say that anonymous functions are <em>syntactic suger</em></p>
<p>另一种构造匿名函数方法：</p>
<pre><code>{ def f(???) = ???; f }</code></pre>
<p>例如：</p>
<pre><code>List.range(0, 10).map({def f(a) = println(a+1); f})</code></pre>
<p>等价于：</p>
<pre><code>List.range(0, 10).map(a:Int =&gt; println(a+1))</code></pre>
<ol start="4" type="1">
<li>Functions Returning Functions</li>
</ol>
<p>Scala中，函数可以将一个函数作为参数，也可以将一个函数作为返回值。如下例：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> progfun {
  <span class="kw">def</span> <span class="fu">sum</span>(f: Int=&gt;Int): (Int, Int) =&gt; Int = {
    <span class="kw">def</span> <span class="fu">sum_i</span>(a:Int, b:Int): Int = {
      <span class="kw">if</span>(a &gt; b) <span class="dv">0</span>
      <span class="kw">else</span> <span class="fu">f</span>(a) + <span class="fu">sum_i</span>(a<span class="dv">+1</span>, b)
    }
    sum_i
  }                              <span class="co">//&gt; sum: (f: Int =&gt; Int)(Int, Int) =&gt; Int</span>
  <span class="fu">sum</span>(x =&gt; x*x*x)(<span class="dv">1</span>,<span class="dv">3</span>)           <span class="co">//&gt; res0: Int = 36</span>
}</code></pre>
<ol start="5" type="1">
<li>Multiple Parameter Lists</li>
</ol>
<p>Scala在定义函数时，可以有一个参数列表，也可以有多个参数列表。如下例：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">sum</span>(f: Int =&gt; Int)(a: Int, b: Int): Int = {
  <span class="kw">if</span>(a &gt; b) <span class="dv">0</span> <span class="kw">else</span> <span class="fu">f</span>(a) + <span class="fu">sum</span>(f)(a<span class="dv">+1</span>, b)
}                                <span class="co">//&gt; sum: (f: Int =&gt; Int)(a: Int, b: Int)Int</span>


<span class="co">// application</span>
<span class="fu">sum</span>(a =&gt; a*a*a)(<span class="dv">2</span>,<span class="dv">4</span>)             <span class="co">//&gt; res0: Int = 99</span></code></pre>
<p>这也是Scala的一个语法糖(syntactic suger)的例子。</p>
<ol start="6" type="1">
<li>Carrying</li>
</ol>
<p>By repeating the process n times</p>
<pre><code>def f(args1):::(argsn 1)(argsn) = E</code></pre>
<p>is shown to be equivalent to</p>
<pre><code>def f = (args1 ) (args2 ) :::(argsn ) E):::))</code></pre>
<p>This style of definition and function application is called currying, named for its instigator, Haskell Brooks Curry (1900-1982), a twentieth century logician.</p>
<p>Conceptually, currying is a fairly simple idea. Wikipedia defines it as follows:</p>
<p>In computer science, currying, invented by Moses Schönfinkel and Gottlob Frege, is the technique of transforming a function that takes multiple arguments into a function that takes a single argument (the other arguments having been specified by the curry).</p>
<p>For example, in Scala, we can write:</p>
<pre><code>def add(x: Int, y: Int) = x + y
add(1, 2)   // 3
add(7, 3)   // 10</code></pre>
<p>And after currying:</p>
<pre><code>def add(x: Int) = (y: Int) =&gt; x + y
add(1)(2)   // 3
add(7)(3)   // 10</code></pre>
<p>You can also use the following syntax to define a curried function:</p>
<pre><code>def add(x: Int)(y: Int) = x+y
add(1)(2)
add(7)(3)</code></pre>
<p>使用Scala Function包中的uncurried函数可以得到一个函数的普通版本。例如：</p>
<pre><code>def sum(a: Int)(b: Int) = a+b
def normalSum = Function.uncurried(sum)
println(sum(1)(2))
println(normalSum(1, 2))</code></pre>
<ol start="7" type="1">
<li><p>Scala中的<code>=&gt;</code>是右结合。例如：</p>
<p>Int =&gt; Int =&gt; Int</p></li>
</ol>
<p>等价于：</p>
<pre><code>Int =&gt; (Int =&gt; Int)</code></pre>
<ol start="8" type="1">
<li>使用Currying来实现一个简单的mapReduce：</li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">mapReduce</span>(f:Int=&gt;Int,combine:(Int,Int)=&gt;Int, zero:Int)(a:Int,b:Int):Int = 
  <span class="kw">if</span>(a &gt; b) zero
  <span class="kw">else</span> <span class="fu">combine</span>(<span class="fu">f</span>(a), <span class="fu">mapReduce</span>(f, combine, zero)(a<span class="dv">+1</span>, b))</code></pre>
<p>上面的</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">sum</span>(f: Int =&gt; Int)(a: Int, b: Int): Int = {
  <span class="kw">if</span>(a &gt; b) <span class="dv">0</span> <span class="kw">else</span> <span class="fu">f</span>(a) + <span class="fu">sum</span>(f)(a<span class="dv">+1</span>, b)
}</code></pre>
<p>可以改成mapReduce的写法：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">sum_mr</span>(f: Int=&gt;Int)(a: Int, b: Int): Int = <span class="fu">mapReduce</span>(f, (x, y)=&gt;x+y, <span class="dv">0</span>)(a, b)</code></pre>
<ol start="9" type="1">
<li><p>在Scala中应该注意：一个函数能够找到（调用）定义在他下边的函数当且仅当这两个函数之间没有求值表达式。</p></li>
<li><p>Types in Scala</p></li>
</ol>
<p>Scala中的几种数据类型：</p>
<ul>
<li>A numeric type: Int, Double, Float, Char, Byte, Long</li>
<li>The Boolean type with the values true and false.</li>
<li>The String type.</li>
<li>A function type, like Int =&gt; Int, (Int, Int) =&gt; Int</li>
</ul>
<ol start="11" type="1">
<li>Class</li>
</ol>
<p>Class可以用来定义新的数据类型。例如，使用Scala按照如下方式来定义分数：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">class</span> <span class="fu">Rational</span>(x: Int, y: Int) {
  <span class="kw">def</span> numer = x
  <span class="kw">def</span> denom = y
}</code></pre>
<p>This definition introduces two entities:</p>
<ul>
<li>A new type, named Rational.</li>
<li>A constructor Rational to create elements of this type.</li>
</ul>
<ol start="12" type="1">
<li>Object</li>
</ol>
<blockquote>
<p>We call the elements of a class type objects.</p>
</blockquote>
<p>如何创建对象：</p>
<pre><code>new Rational(1, 2)</code></pre>
<ol start="13" type="1">
<li>Methods</li>
</ol>
<p>类的方法相关的示例：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">class</span> <span class="fu">Rational</span>(x: Int, y: Int) {
  <span class="kw">def</span> numer = x
  <span class="kw">def</span> denom = y
  <span class="kw">def</span> <span class="fu">add</span>(that: Rational) =
    <span class="kw">new</span> <span class="fu">Rational</span>(numer*that.<span class="fu">denom</span> + that.<span class="fu">numer</span>*denom,
        denom*that.<span class="fu">denom</span>)
  <span class="kw">def</span> neg: Rational = <span class="kw">new</span> <span class="fu">Rational</span>(-numer, -denom)
  <span class="kw">override</span> <span class="kw">def</span> <span class="fu">toString</span>(): String = numer + <span class="st">&quot;/&quot;</span> + denom
}</code></pre>
<p>此处的<code>toStirng</code>方法是覆盖Object类的方法，因此，需要显式地加上一个<code>override</code>，否则将会出现编译错误。这个<code>toString</code>函数也可以简单地写成：</p>
<pre><code>override def toString = numer + &quot;/&quot; + denom</code></pre>
<p>这也体现出了Scala语言本身语法的灵活性。</p>
<ol start="14" type="1">
<li>值得注意的是，上述的Scala代码编译后得到的class文件反编译为java文件是这样的：</li>
</ol>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> Rational
{
  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> x;
  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> y;

  <span class="kw">public</span> <span class="dt">int</span> <span class="fu">numer</span>()
  {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">x</span>;
  }

  <span class="kw">public</span> <span class="dt">int</span> <span class="fu">denom</span>()
  {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">y</span>;
  }

  <span class="kw">public</span> Rational <span class="fu">add</span>(Rational that)
  {
    <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Rational</span>(<span class="fu">numer</span>() * that.<span class="fu">denom</span>() + that.<span class="fu">numer</span>() * <span class="fu">denom</span>(), 
      <span class="fu">denom</span>() * that.<span class="fu">denom</span>());
  }

  <span class="kw">public</span> String <span class="fu">toString</span>()
  {
    <span class="kw">return</span> <span class="kw">new</span> StringBuilder().<span class="fu">append</span>(<span class="fu">numer</span>())
                              .<span class="fu">append</span>(<span class="st">&quot;/&quot;</span>)
                              .<span class="fu">append</span>(BoxesRunTime.<span class="fu">boxToInteger</span>(<span class="fu">denom</span>()))
                              .<span class="fu">toString</span>();
  }
}</code></pre>
<p>另外，我发现</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">gcd</span>(a: Int, b: Int): Int = <span class="kw">if</span>(b == <span class="dv">0</span>) a <span class="kw">else</span> <span class="fu">gcd</span>(b, a%b)</code></pre>
<p>对应的java代码是这样的：</p>
<pre class="sourceCode java"><code class="sourceCode java"><span class="kw">private</span> <span class="dt">int</span> <span class="fu">gcd</span>(<span class="dt">int</span> a, <span class="dt">int</span> b)
{
    <span class="kw">for</span> (;;)
    {
        <span class="kw">if</span> (b == <span class="dv">0</span>) {
            <span class="kw">return</span> a;
        }
        b = a % b;a = b;
    }
}</code></pre>
<p>可见，Scala编译器对于递归的优化做得相当不错。</p>
<ol start="15" type="1">
<li><p>Data Abstraction: This ability to choose diﬀerent implementations of the data without affecting clients is called data abstraction.</p></li>
<li><p>Self Reference：Scala中也有与Java对应的this的概念和语法。</p></li>
<li><p>Preconditions: 定义类的构造方法的前置条件require</p></li>
</ol>
<p>在上面的分数的例子中，分母不能为0，可以使用require来做一下限制：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">class</span> <span class="fu">Rational</span>(x: Int, y: Int) {
  <span class="fu">require</span>(x != <span class="dv">0</span>, <span class="st">&quot;the denominator can&#39;t be zero.&quot;</span>)
  <span class="kw">def</span> numer = x
  <span class="kw">def</span> denom = y
}</code></pre>
<p>如果传入的参数y为0，将会产生一个IllegalArgumentException:</p>
<pre><code>var t = new Rational(10, 0)</code></pre>
<p>抛出异常：</p>
<pre><code>java.lang.IllegalArgumentException: requirement failed: the denominator can&#39;t be zero.</code></pre>
<p>关于require的详细解释如下：</p>
<blockquote>
<p>require is a predeﬁned function.</p>
</blockquote>
<blockquote>
<p>It takes a condition and an optional message string.</p>
</blockquote>
<blockquote>
<p>If the condition passed to require is false, an IllegalArgumentException is thrown with the given message string.</p>
</blockquote>
<ol start="18" type="1">
<li>Assertions</li>
</ol>
<p>失败时同样是抛出一个java.lang.IllegalArgumentException。</p>
<p>二者的区别：</p>
<ul>
<li>require is used to enforce a precondition on the caller of a function.</li>
<li>assert is used as to check the code of the function itself.</li>
</ul>
<ol start="19" type="1">
<li>构造函数示例：</li>
</ol>
<p>Scala中，直接使用this来定义构造函数。如下例：</p>
<pre><code>def this(x: Int) = this(x, 1)</code></pre>
<ol start="20" type="1">
<li><p>Scala的求值模型为实参替换形参的求值模型(based on substitution)。</p></li>
<li><p>操作符重载：</p></li>
</ol>
<p>重载+, -, *, /, &lt;, &gt;</p>
<pre><code>def + (r: Rational) = new Rational(numer*r.denom + r.numer*denom,
                                   denom*r.denom)</code></pre>
<p>重载负号(-)</p>
<p>符号是一个一元运算符(Unary operator)：</p>
<pre><code>def unary_- : Rational = new Rational(-numer, denom)</code></pre>
<p>注意，<code>-</code>和<code>:</code>之间的空格不能省略，否则会导致编译器认为<code>-:</code>是一个运算符。</p>
<h2 id="week-3-data-and-abstraction">Week 3: Data and Abstraction</h2>
<ol type="1">
<li>Abstraction Classes, 抽象类。</li>
</ol>
<p>Abstraction classes can contain members which are missing an implementations. No instance of an abstract class can be created with the operator new.</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">abstract</span> <span class="kw">class</span> IntSet {
  <span class="kw">def</span> <span class="fu">incl</span>(x: Int): IntSet
  <span class="kw">def</span> <span class="fu">contains</span>(x: Int): Boolean
}</code></pre>
<ol start="2" type="1">
<li>Class Extensions</li>
</ol>
<p>Scala中类支持继承，示例：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">class</span> Empty <span class="kw">extends</span> IntSet {
  <span class="kw">def</span> <span class="fu">incl</span>(x: Int): IntSet = ???
  <span class="kw">def</span> <span class="fu">contains</span>(x: Int): Boolean = ???
}</code></pre>
<p>但，如果子类也是abstract修饰的，那么就可以不同实现父类的所有抽象方法。</p>
<ol start="3" type="1">
<li>直接定义object：全局唯一的类的实例(singleton object)。例如上面的例子里的<code>Empty</code>类的实例都是相同的。可以写成：</li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> Empty <span class="kw">extends</span> IntSet {
  <span class="kw">def</span> <span class="fu">incl</span>(x: Int): IntSet = <span class="kw">new</span> <span class="fu">NonEmpty</span>(x, Empty, Empty)
  <span class="kw">def</span> <span class="fu">contains</span>(x: Int): Boolean = <span class="kw">false</span>
}</code></pre>
<p>但是，使用object继承一个class时，这个class不能有未实现的方法。</p>
<p>这种object会在第一次引用时被创建，不能使用<code>new</code>来创建实例。</p>
<p>main函数：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> Hello {
  <span class="kw">def</span> <span class="fu">main</span>(args: Array[String]) = <span class="fu">println</span>(<span class="st">&quot;hello scala.&quot;</span>)
}</code></pre>
<ol start="4" type="1">
<li>Dynamic Binding</li>
</ol>
<blockquote>
<p>Object-oriented languages(including Scala) implement dynamic method dispatch. This means that the code invoked by a method call depends on the runtime type of the object that contains the method.</p>
</blockquote>
<blockquote>
<p>Dynamic dispatch of methods is analogous to calls to higher-order functions.</p>
</blockquote>
<ol start="5" type="1">
<li>Package</li>
</ol>
<p>Scala中import的三种语法：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">import</span> A.<span class="fu">func</span>
<span class="kw">import</span> A.{func1, func2}
<span class="kw">import</span> a.<span class="fu">_</span>  <span class="co">// 导入整个包里的所有内容</span></code></pre>
<ol start="6" type="1">
<li>Traits</li>
</ol>
<blockquote>
<p>In Java, as well as in Scala, a class can only have one superclass. But what if a class has several natural supertypes to which it conforms or from which it wants to inherit code? Here, you could use traits.</p>
</blockquote>
<p>Wikipedia上关于Traits的解释：<a href="https://en.wikipedia.org/wiki/Trait_(computer_programming)">Trait_(computer_programming)</a>。</p>
<p>A trait represents a collection of methods, that can be used to extend the functionality of a class.</p>
<p>Scala中实现trait的语法：</p>
<pre><code>class A extends TA with TB with TC</code></pre>
<p>表示类A继承并且实现了trait TA, TB, TC。多继承时，多个父级trait之间用<code>with</code>连接。</p>
<p>Traits不能有参数。Traits仅仅是一系列方法的集合。</p>
<blockquote>
<p>Traits resemble interfaces in Java, but are more powerful because they can contains ﬁelds and concrete methods.</p>
</blockquote>
<p>Traits中的方法可以有默认实现(default implementations)。</p>
<ol start="7" type="1">
<li>Top Types in Scala</li>
</ol>
<ul>
<li>Any: the base type of all types, Methods: ‘==‘, ‘!=‘, ‘equals‘, ‘hashCode, ‘toString‘</li>
<li>AnyRef: The base type of all reference types, Alias of ‘java.lang.Object‘</li>
<li>AnyVal: The base type of all primitive types</li>
</ul>
<p>Scala的类型继承关系图：</p>
<figure>
<img src="http://sighingnow.github.io/resource/scala_coursera_notes/scala_class_hierarchy.png" />
</figure>
<ol start="8" type="1">
<li>Nothing</li>
</ol>
<blockquote>
<p>Nothing is at the bottom of Scala’s type hierarchy. It’s a subtype of every other type. There is no value of type Nothing.</p>
</blockquote>
<p>Nothing的两个用途：</p>
<ul>
<li>To signal abnormal termination</li>
<li>As an element type of empty collections (see next session), 例如：Set[Nothing]</li>
</ul>
<pre><code>def func(): Nothing = throw new Exception(&quot;Nothing.&quot;)</code></pre>
<ol start="9" type="1">
<li>Scala.Null</li>
</ol>
<p><code>Scala.Null</code> is a subtype of every other type. The type of <code>null</code> is <code>Scala.Null</code>.</p>
<ol start="10" type="1">
<li>多态(Polymorphism)</li>
</ol>
<p>Polymorphism means that a function type comes “in many forms”. In programming it means that:</p>
<ul>
<li>the function can be applied to arguments of many types.</li>
<li>the type can have instances of many types.</li>
</ul>
<p>Two principal forms of polymorphism:</p>
<ul>
<li>subtyping: instances of a subclass can be passed to a base class.</li>
<li>generics: instances of a function or class are created by type parameterization.</li>
</ul>
<ol start="11" type="1">
<li>参数化(Parametrization): Type parameterization means that classes as well as methods can now have types as parameters.</li>
</ol>
<p>在Scala中，类和函数都可以拥有泛型参数。</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">class</span> A[T](ae: T) {
  <span class="kw">def</span> e = ae
}

<span class="kw">def</span> func[T](e: T) = <span class="fu">println</span>(e)</code></pre>
<ol start="12" type="1">
<li>type erasure</li>
</ol>
<p>Type parameters do not affect evaluation in Scala. We can assume that all type parameters and type arguments are removed before evaluating the program.</p>
<ul>
<li>Languages that use type erasure include: Java, Scala, Haskell, ML, OCaml.</li>
<li>Languages that keep the type parameters around at run time: C++, C#, F#.</li>
</ul>
<h2 id="week-4-types-and-pattern-matching">Week 4: Types and Pattern Matching</h2>
<ol type="1">
<li>Functions as Objects</li>
</ol>
<p>In fact function values are treated as objects in Scala. Functions are objects with apply methods.</p>
<p>例如Scala.Function, Scala.Function1, etc.</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">package</span> scala
<span class="kw">trait</span> Function1[A, B] {
  <span class="kw">def</span> <span class="fu">apply</span>(x: A): B
}</code></pre>
<ol start="2" type="1">
<li>Expansion of Function Values</li>
</ol>
<p>匿名函数(Anonymous Function)</p>
<pre class="sourceCode scala"><code class="sourceCode scala">(x: Int) =&gt; x * x</code></pre>
<p>展开后的形式为：</p>
<pre class="sourceCode scala"><code class="sourceCode scala">{
  <span class="kw">class</span> AnonFun <span class="kw">extends</span> Function1[Int, Int] {
    <span class="kw">def</span> <span class="fu">apply</span>(x: Int) = x * x
  }
  <span class="kw">new</span> AnonFun
}</code></pre>
<p>再举一个相关的例子：</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">import</span> scala.<span class="fu">Function1</span>

<span class="kw">object</span> progfun {
  <span class="fu">println</span>(<span class="st">&quot;Welcome to the Scala worksheet&quot;</span>)       <span class="co">//&gt; Welcome to the Scala worksheet</span>
  <span class="kw">val</span> f = <span class="kw">new</span> Function1[Int, Int] {
    <span class="kw">def</span> <span class="fu">apply</span>(x: Int) = x * x
  }                                               <span class="co">//&gt; f  : Int =&gt; Int = &lt;function1&gt;</span>
  f.<span class="fu">apply</span>(<span class="dv">7</span>)                                      <span class="co">//&gt; res0: Int = 49</span>

  <span class="kw">object</span> One {
    <span class="kw">def</span> <span class="fu">apply</span>() = <span class="fu">println</span>(<span class="st">&quot;no arg&quot;</span>)
    <span class="kw">def</span> <span class="fu">apply</span>(x: Int) = <span class="fu">println</span>(<span class="st">&quot;one arg&quot;</span>)
    <span class="kw">def</span> <span class="fu">apply</span>(x: Int, y: Int) = <span class="fu">println</span>(<span class="st">&quot;two args&quot;</span>)
  }
  <span class="fu">One</span>()                                           <span class="co">//&gt; no arg</span>
  <span class="fu">One</span>(<span class="dv">1</span>)                                          <span class="co">//&gt; one arg</span>
  <span class="fu">One</span>(<span class="dv">1</span>, <span class="dv">2</span>)                                       <span class="co">//&gt; two args</span>
}</code></pre>
<ol start="3" type="1">
<li><p><code>Function1</code>的定义如下：<code>trait Function1[-T1, +R] extends AnyRef</code>。</p></li>
<li><p>A pure object-oriented language is one in which every value is an object. If the language is based on classes, this means that the type of each value is a class.</p></li>
<li><p>在Scala中，任何数据类型都可以用类表达出来。</p></li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> progfun {
  <span class="kw">class</span> Int {
    <span class="kw">def</span> + (that: Int): Int
    <span class="kw">def</span> - (that: Int): Int
    <span class="kw">def</span> * (that: Int): Int
    <span class="kw">def</span> / (that: Int): Int
    <span class="co">// ...</span>
  }
}</code></pre>
<ol start="6" type="1">
<li><p>Polymorphism: 多态：两个方面：子类型(Subtyping)、泛型(generics)。</p></li>
<li><p>Type Bounds and Variance</p>
<ul>
<li>Type Bounds: subject the type parameters to sub type constraints.</li>
<li>Variance: defines how parameterized types behave under sub typing.</li>
</ul></li>
<li><p>Generally, the notation</p>
<ul>
<li><code>S &lt;: T</code> means: S is a subtype of T. (upper bound)</li>
<li><code>S &gt;: T</code> means: S is a supertype of T, or T is a subtype of S. (lower bound)</li>
<li><code>[S &gt;: T &lt;: R]</code> means: S is a subtype of T, and S is a subtype of R. It would restrict S any type on the interval between T and R. (mixed bound)</li>
</ul></li>
<li><p>The Liskov Substitution Principle</p></li>
</ol>
<p>Substitutability is a principle in object-oriented programming. It states that, in a computer program, if S is a subtype of T, then objects of type T may be replaced with objects of type S without altering any of the desirable properties of that program (correctness, task performed, etc.). More formally, the Liskov substitution principle (LSP) is a particular definition of a subtyping relation, called (strong) behavioral subtyping, that was initially introduced by Barbara Liskov in a 1987 conference keynote address entitled Data abstraction and hierarchy.</p>
<p>In Scala, If <code>A &lt;: B</code>, then everything one can to do with a value of type B one should also be able to do with a value of type A.</p>
<ol start="10" type="1">
<li><p>Say <code>C[T]</code> is a parameterized type and A, B are types such that <code>A &lt;: B</code>. In general, there are three possible relationships between C[A] and C[B]:</p>
<ul>
<li><code>C[A] &lt;: C[B]</code>: C is <strong>covariant</strong>(co-variant)</li>
<li><code>C[A] &gt;: C[B]</code>: C is <strong>contravariant</strong>(contra-variant)</li>
<li>neither C[A] or C[B] is a subtype of the other: C is <strong>nonvariant</strong>(non-variant)</li>
</ul></li>
</ol>
<p>Scala lets you declare the variance of a type by annotating the type parameter:</p>
<ul>
<li><code>class C[+A] { ... }</code> C is <strong>covariant</strong></li>
<li><code>class C[-A] { ... }</code> C is <strong>contravariant</strong></li>
<li><code>class C[A] { ... }</code> C is <strong>novariant</strong></li>
</ul>
<ol start="11" type="1">
<li>Variance check.</li>
</ol>
<p>Rules:</p>
<ul>
<li>covariant type parameters can only appear in method results.</li>
<li>contravariant type parameters can only appear in method parameters.</li>
<li>invariant type parameters can appear anywhere.</li>
</ul>
<p>A problematic example:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">trait</span> List[+T] {
  <span class="kw">def</span> isEmpty = <span class="kw">false</span>
  <span class="kw">def</span> <span class="fu">prepend</span>(elem: T): List[T] = <span class="kw">new</span> <span class="fu">Cons</span>(elem, <span class="kw">this</span>)
}

<span class="kw">class</span> Cons[T](<span class="kw">val</span> head: T, <span class="kw">val</span> tail: List[T]) <span class="kw">extends</span> List[T] {
  <span class="kw">override</span> <span class="kw">def</span> isEmpty: Boolean = <span class="kw">false</span>
}

<span class="kw">object</span> Nil <span class="kw">extends</span> List[Nothing] {
  <span class="kw">override</span> <span class="kw">def</span> isEmpty: Boolean = <span class="kw">true</span>
}</code></pre>
<p>In function <code>prepend</code>, covariant type parameter <code>T</code> is used in method parameters, then, the compiler will report a error:</p>
<p><strong><code>covariant type T occurs in contravariant position in type T of value elem</code></strong></p>
<p>How to correct it, make it variance-correct ? The answer is that use lower bounds:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">trait</span> List[+T] {
  <span class="kw">def</span> isEmpty = <span class="kw">false</span>
  <span class="kw">def</span> prepend[U &gt;: T](elem: U): List[U] = <span class="kw">new</span> <span class="fu">Cons</span>(elem, <span class="kw">this</span>)
}</code></pre>
<p>More, the method <code>prepend</code> <strong>violates LSP</strong> (Liskov Substitution Principle). If <code>xs</code> is a list of type <code>List[NonEmpty]</code>, when we call <code>xs.prepend(Empty)</code>, it would lead to a type error. <code>xs.prepend</code> requires a <code>NonEmpty</code> object, and found <code>Empty</code>, but, <code>List[NonEmpty]</code> is also a subtype of <code>List[IntSet]</code>. so, it’s problematic.</p>
<p><strong>We can see that the variance checking rules was actually invented to prevent mutable operations in covariant class, also rules out something which doesn’t involve any mutability at all.</strong></p>
<p>Covariant type parameters may appear in lower bounds of method type parameters, and contravariant type parameters may appear in upper bounds of method.</p>
<ol start="12" type="1">
<li>Pattern Matching</li>
</ol>
<p><strong>Pattern Matching</strong> is a generalization of <code>switch</code> from C/Java to class hierarchies.</p>
<ol start="13" type="1">
<li>Match Syntax:</li>
</ol>
<ul>
<li><code>match</code> is followed by a sequence of cases, <code>pat =&gt; expr</code>.</li>
<li>Each case associates an expression expr with a pattern pat.</li>
<li>A MatchError exception is thrown if no pattern matches the value of the selector.</li>
</ul>
<pre class="sourceCode scala"><code class="sourceCode scala">e <span class="kw">match</span> { <span class="kw">case</span> p1 =&gt; e1 ... <span class="kw">case</span> pn =&gt; en }</code></pre>
<p>Patterns are constructed from:</p>
<ul>
<li>constructors, e.g. <code>Number</code>, <code>Sum</code>(case class),</li>
<li>variables, e.g. n, <code>e1</code>, <code>e2</code>,</li>
<li>wildcard patterns <code>_</code>, <strong>Important</strong></li>
<li>constants, e.g. <code>1</code>, <code>true</code>.</li>
</ul>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> Progfun {
  <span class="kw">def</span> <span class="fu">func</span>() = {
    <span class="kw">val</span> d = <span class="dv">1</span>;
    d <span class="kw">match</span> {
      <span class="kw">case</span> <span class="dv">1</span> =&gt; <span class="st">&quot;abcd&quot;</span>
      <span class="kw">case</span> <span class="dv">2</span> =&gt; <span class="st">&quot;efgh&quot;</span>
      <span class="kw">case</span> _ =&gt; <span class="st">&quot;catch default value.&quot;</span>
    }
  }
  <span class="kw">def</span> <span class="fu">main</span>(args: Array[String]) = {
    <span class="fu">println</span>(<span class="fu">func</span>())
  }
}</code></pre>
<p>在这个例子中，<code>match</code>匹配到<code>1</code>之后，<code>func</code>函数直接返回<code>&quot;abcd&quot;</code>，不会接着运行后面的语句，不需要<code>break</code>。</p>
<ol start="14" type="1">
<li>Using <code>case class</code> in Lambda expressions.</li>
</ol>
<p>Something, we need to construct a complex data structure(link tuple) as Lambda’s parameter, we can use <code>case</code> here:</p>
<pre class="sourceCode scala"><code class="sourceCode scala">List((&#39;a&#39;, <span class="dv">97</span>), (&#39;b&#39;, <span class="dv">98</span>), (&#39;c&#39;, <span class="dv">99</span>)) <span class="fu">map</span> ({ <span class="kw">case</span> (c, i) =&gt; <span class="fu">println</span>(c + <span class="st">&quot; &quot;</span> + String.<span class="fu">valueOf</span>(i)) })
                                                  <span class="co">//&gt; a 97</span>
                                                  <span class="co">//| b 98</span>
                                                  <span class="co">//| c 99</span>
                                                  <span class="co">//| res1: List[Unit] = List((), (), ())</span></code></pre>
<p>If we simply use <code>map((c, i) =&gt; println(c + &quot; &quot; + String.valueOf(i)))</code>, we will get a error report and suggestion from Scala compiler:</p>
<pre><code>Multiple markers at this line
- missing parameter type
- missing parameter type Note: The expected type requires a one-argument function accepting a 2-Tuple.</code></pre>
<p>Suggestion from compiler:</p>
<blockquote>
<p><strong>Consider a pattern matching anonymous function, <code>{ case (c, i) =&gt;  ... }</code></strong></p>
</blockquote>
<ol start="15" type="1">
<li><p>How does a case class differ from a normal class?</p></li>
<li>You can do pattern matching on it,</li>
<li>You can construct instances of these classes <strong>without using the <code>new</code> keyword</strong>,</li>
<li>All constructor arguments are accessible from outside using automatically generated accessor functions,</li>
<li>The <code>toString</code> method is automatically redefined to print the name of the case class and all its arguments,</li>
<li>The <code>equals</code> method is automatically redefined to compare two instances of the same case class structurally rather than by identity.</li>
<li><p>The <code>hashCode</code> method is automatically redefined to use the hashCodes of constructor arguments.</p></li>
</ol>
<p>Most of the time you declare a class as a case class because of point 1, i.e. to be able to do pattern matching on its instances. But of course you can also do it because of one of the other points.</p>
<p><strong>Case classes</strong> can be seen as plain and <strong>immutable data-holding objects</strong> that should exclusively depend on their constructor arguments. This functional concept allows us to</p>
<ul>
<li>use a compact initialisation syntax (<code>Node(1, Leaf(2), None)</code>)</li>
<li>decompose them using pattern matching</li>
<li>have equality comparisons implicitly defined</li>
</ul>
<p>In combination with inheritance, case classes are used to mimic(模仿) <strong>algebraic datatypes</strong>.</p>
<h2 id="week-5-lists">Week 5: Lists</h2>
<ol type="1">
<li><p>Higher-Order List Functions</p></li>
<li><p>Map and Filter</p></li>
<li><p>Equational Proof on Lists</p></li>
<li><p>List.groupBy</p></li>
</ol>
<pre><code>def groupBy[K](f: (A) ⇒ K): Map[K, List[A]]</code></pre>
<blockquote>
<p>Partitions this traversable collection into a map of traversable collections according to some discriminator function.</p>
</blockquote>
<blockquote>
<p>Note: this method is not re-implemented by views. This means when applied to a view it will always force the view and return a new traversable collection.</p>
</blockquote>
<p>Example:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> progfun {
  <span class="st">&quot;abcd&quot;</span>.<span class="fu">groupBy</span>(x =&gt; x)    <span class="co">//&gt; res0: scala.collection.immutable.Map[Char,String] = </span>
                            <span class="co">//|   Map(b -&gt; b, d -&gt; d, a -&gt; a, c -&gt; c)</span>

  <span class="st">&quot;abcdaa&quot;</span>.<span class="fu">groupBy</span>(x =&gt; x)  <span class="co">//&gt; res0: scala.collection.immutable.Map[Char,String] = </span>
                            <span class="co">//| Map(b -&gt; b, d -&gt; d, a -&gt; aaa, c -&gt; c)</span>
}</code></pre>
<p>Push all elements which having the same result of <code>f: param =&gt; retval</code> to a same group, and build a map (retval -&gt; group). Then, build all maps to a List.</p>
<h2 id="week-6-collections">Week 6: Collections</h2>
<ol type="1">
<li>Generate Pairs</li>
</ol>
<p>The Law is that:</p>
<pre class="sourceCode scala"><code class="sourceCode scala">xs flatMap f = (xs map f).<span class="fu">flatten</span></code></pre>
<ol start="2" type="1">
<li>The difference between <code>map</code> and <code>flatMap</code>: flatMap works applying a function <strong>that returns a sequence for each element in the list</strong>, and <strong>flattening</strong> the results into the original list.</li>
</ol>
<p>For Example:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> progfun {
  <span class="kw">val</span> x = <span class="dv">1</span> until <span class="dv">3</span>
  <span class="kw">def</span> <span class="fu">f</span>(x: Int) = List(x<span class="dv">-1</span>, x, x<span class="dv">+1</span>)
  x <span class="fu">map</span> (f)
  x flatMap f
}</code></pre>
<p>在Scala Worksheet中的运行结果：</p>
<pre><code>res0: [List[Int]] = Vector(List(0, 1, 2), List(1, 2, 3))
res1: [Int] = Vector(0, 1, 2, 1, 2, 3)</code></pre>
<ol start="3" type="1">
<li>For-Expression</li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">for</span> (p &lt;- persons <span class="kw">if</span> p.<span class="fu">age</span> &gt; <span class="dv">20</span>) <span class="kw">yield</span> p.<span class="fu">name</span></code></pre>
<p>is equivalent to</p>
<pre class="sourceCode scala"><code class="sourceCode scala">persons <span class="fu">filter</span> (p =&gt; p.<span class="fu">age</span> &gt; <span class="dv">20</span>) <span class="fu">map</span> (p =&gt; p.<span class="fu">name</span>)</code></pre>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">object</span> progfun {
  <span class="kw">for</span> {
    i &lt;- <span class="dv">1</span> until <span class="dv">4</span>
    j &lt;- <span class="dv">1</span> until i
    <span class="kw">if</span> i + j &lt; <span class="dv">6</span>
  } <span class="kw">yield</span> (i, j)
}</code></pre>
<p>的运行结果为：</p>
<pre><code>res0: [(Int, Int)] = Vector((2,1), (3,1), (3,2))</code></pre>
<p>Higher-order functions such as map, flatMap or filter provide powerful constructs for manipulating lists, but sometimes the level of abstraction required by these function make the program difficult to understand.</p>
<p>In this case, Scala’s for expression notation can help.</p>
<ol start="4" type="1">
<li>Translation of For</li>
</ol>
<p>The syntax of for is closely related to the higher-order functions <code>map</code>, <code>flatMap</code> and <code>filter</code>. These functions can all be defined in terms of for:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> mapFun[T, U](xs: List[T], f: T =&gt; U): List[U] =
  <span class="kw">for</span> (x &lt;- xs) <span class="kw">yield</span> <span class="fu">f</span>(x)
<span class="kw">def</span> flatMap[T, U](xs: List[T], f: T =&gt; Iterable[U]): List[U] = 
  <span class="kw">for</span> (x &lt;- xs; y &lt;- <span class="fu">f</span>(x)) <span class="kw">yield</span> y
<span class="kw">def</span> filter[T](xs: List[T], p: T =&gt; Boolean): List[T] =
  <span class="kw">for</span> (x &lt;- xs <span class="kw">if</span> <span class="fu">p</span>(x)) <span class="kw">yield</span> x</code></pre>
<ol start="5" type="1">
<li><code>Filter</code> and <code>withFilter</code></li>
</ol>
<p>From the scala docs:</p>
<blockquote>
<p>Note: the difference between c filter p and c withFilter p is that the former creates a new collection, whereas the latter only restricts the domain of subsequent map, flatMap, foreach, and withFilter operations.</p>
</blockquote>
<p>So filter will take the original collection and produce a new collection, but withFilter will non-strictly (ie. lazily) pass unfiltered values through to later map/flatMap/withFilter calls, saving a second pass through the (filtered) collection. Hence it will be more efficient when passing through to these subsequent method calls.</p>
<p>In fact, withFilter is specifically designed for working with chains of these methods, which is what a for comprehension is de-sugared into. No other methods (such as forall/exists) are required for this, so they have not been added to the FilterMonadic return type of withFilter.</p>
<ol start="6" type="1">
<li><code>for</code> and database. Similar ideas underly Microsoft’s LINQ.</li>
</ol>
<h2 id="week-7-lazy-evaluation">Week 7: Lazy Evaluation</h2>
<ol type="1">
<li>Proof the implementations.</li>
</ol>
<blockquote>
<p>What does it mean to prove the correctness of this implementation?</p>
</blockquote>
<blockquote>
<p>One way to define and show the correctness of an implementation consists of proving the laws that it respects.</p>
</blockquote>
<p>(From Martin Odersky’s slides)</p>
<ol start="2" type="1">
<li>Stream</li>
</ol>
<p>Streams are similar to lists, but their tail is evaluated <strong>only on demand</strong>.</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">lazy</span> <span class="kw">val</span> fibs: Stream[Int] = <span class="dv">0</span> #:: <span class="dv">1</span> #:: fibs.<span class="fu">zip</span>(fibs.<span class="fu">tail</span>).<span class="fu">map</span> { n =&gt; n.<span class="fu">_1</span> + n.<span class="fu">_2</span> }
fibs take <span class="dv">10</span> foreach println</code></pre>
<p>Another example:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">val</span> nums = Stream.<span class="fu">from</span>(<span class="dv">1</span>)                       <span class="co">//&gt; nums  : scala.collection.immutable.Stream[Int] = Stream(1, ?)</span>
nums.<span class="fu">take</span>(<span class="dv">10</span>).<span class="fu">toList</span>                            <span class="co">//&gt; res0: List[Int] = List(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</span></code></pre>
<p>This is a common but important way to get a list of integers with variable length.</p>
<ol start="3" type="1">
<li>Stream Cons Operator</li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala">#:: xs == Stream.<span class="fu">cons</span>(x, xs)</code></pre>
<ol start="4" type="1">
<li>Lazy Evaluation</li>
</ol>
<p>Lazy Evaluation: do thing as late as possible and never do then twice.</p>
<blockquote>
<p>The proposed implementation suffers from a serious potential performance problem: If tail is called several times, the corresponding stream will be recomputed each time.</p>
</blockquote>
<blockquote>
<p>This problem can be avoided by storing the result of the first evaluation of tail and re-using the stored result instead of recomputing tail.</p>
</blockquote>
<blockquote>
<p>In a purely functional language an expression produces the same result each time it is evaluated.</p>
</blockquote>
<ol start="5" type="1">
<li><p>Evaluation Strategies</p>
<ul>
<li>lazy evaluation</li>
<li>by-name evaluation: everything is recomputed</li>
<li>strict evaluation: normal parameters and <code>val</code> definitions.</li>
</ul></li>
<li><p>Infinite Streams</p></li>
</ol>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">from</span>(n: Int): Stream[Int] = n #:: <span class="fu">from</span>(n<span class="dv">+1</span>)
<span class="kw">val</span> ints = <span class="fu">from</span>(<span class="dv">0</span>)
ints take <span class="dv">10</span> foreach println</code></pre>
<ol start="7" type="1">
<li>The Sieve of Eratosthenes</li>
</ol>
<p>The Sieve of Eratosthenes is an ancient technique to calculate prime numbers.</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">from</span>(n: Int): Stream[Int] = n #:: <span class="fu">from</span>(n<span class="dv">+1</span>)
<span class="kw">def</span> <span class="fu">sieve</span>(s: Stream[Int]): Stream[Int] = 
  s.<span class="fu">head</span> #:: <span class="fu">sieve</span>(s.<span class="fu">tail</span> <span class="fu">filter</span> (_ % s.<span class="fu">head</span> != <span class="dv">0</span>))
<span class="kw">val</span> primes = <span class="fu">sieve</span>(<span class="fu">from</span>(<span class="dv">2</span>))</code></pre>
<ol start="8" type="1">
<li>Conclusion</li>
</ol>
<p>Functional programming provides a coherent set of notations and methods based on</p>
<ul>
<li>higher-order functions,</li>
<li>case classes and pattern matching,</li>
<li>immutable collections,</li>
<li>absence of mutable state,</li>
<li>flexible evaluation strategies: <code>strict/lazy/by name</code>.</li>
</ul>
<h2 id="the-end">The End</h2>
<p>Finish this course. 2015-07-31, at Beihang University.</p>

        <br/>
        <span class="fa fa-tag"></span>Tags:
        
          		
            <a href="/tags#Scala"><span class="label label-primary">Scala</span></a>
          
        
        <br/><br/>
        <br/><br/><h3>Comments:</h3>
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'sighingnow';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </article> 
      
      <div class="row">
        <div class="col-sm-6 col-xs-6 text-left">
       	
        	<a class="btn btn-blue" href="/web-tech/web_video_background.html">← Previous</a>
        
        </div>
        <div class="col-sm-6 col-xs-6 text-right">
        
        	<a class="btn btn-blue" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/haskell_make_types_and_typeclasses.html">Next →</a>
         
        </div>
      </div>
      
      <footer class="row">
      <div class="col-ms-12 text-center"><div id="clustrmaps-widget" style="margin-left: auto; margin-right: auto;"></div><script type="text/javascript">var _clustrmaps = {'url' : 'http://sighingnow.github.io', 'user' : 1175527, 'server' : '3', 'id' : 'clustrmaps-widget', 'version' : 1, 'date' : '2015-08-01', 'lang' : 'en', 'corners' : 'square' };(function (){ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'http://www3.clustrmaps.com/counter/map.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);})();</script><noscript><a href="http://www3.clustrmaps.com/user/4e211efe7"><img src="http://www3.clustrmaps.com/stats/maps-no_clusters/sighingnow.github.io-thumb.jpg" alt="Locations of visitors to this page" /></a></noscript>

</div>
      <div class="col-ms-12 text-center">
            <hr/>
            
                  <div>
<a href="mailto:sighingnow@gmail.com"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.224580688,30 C0.224580688,13.4314567 13.454941,0 29.7754193,0 C46.0958976,0 59.3262579,13.4314567 59.3262579,30 C59.3262579,46.5685433 46.0958976,60 29.7754193,60 C13.454941,60 0.224580688,46.5685433 0.224580688,30 Z M0.224580688,30" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M35.0384324,31.6384006 L47.2131148,40.5764264 L47.2131148,20 L35.0384324,31.6384006 Z M13.7704918,20 L13.7704918,40.5764264 L25.9449129,31.6371491 L13.7704918,20 Z M30.4918033,35.9844891 L27.5851037,33.2065217 L13.7704918,42 L47.2131148,42 L33.3981762,33.2065217 L30.4918033,35.9844891 Z M46.2098361,20 L14.7737705,20 L30.4918033,32.4549304 L46.2098361,20 Z M46.2098361,20" id="Shape" fill="#333333" sketch:type="MSShapeGroup"></path>
    <path d="M59.3262579,30 C59.3262579,46.5685433 46.0958976,60 29.7754193,60 C23.7225405,60 18.0947051,58.1525134 13.4093244,54.9827754 L47.2695458,5.81941103 C54.5814438,11.2806503 59.3262579,20.0777973 59.3262579,30 Z M59.3262579,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>
<a href="http://facebook.com/sighingnow"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.112290344,30 C0.112290344,13.4314567 13.3426506,0 29.663129,0 C45.9836073,0 59.2139676,13.4314567 59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C13.3426506,60 0.112290344,46.5685433 0.112290344,30 Z M0.112290344,30" fill="#3B5998" sketch:type="MSShapeGroup"></path>
	<path d="M32.1341457,46.3196729 L32.1341457,29.9980891 L36.5657565,29.9980891 L37.1530406,24.3735809 L32.1341457,24.3735809 L32.141675,21.5584604 C32.141675,20.091502 32.2787707,19.3054722 34.351206,19.3054722 L37.1216686,19.3054722 L37.1216686,13.6803271 L32.6894304,13.6803271 C27.3655995,13.6803271 25.491749,16.4088187 25.491749,20.9972835 L25.491749,24.3742179 L22.1732173,24.3742179 L22.1732173,29.998726 L25.491749,29.998726 L25.491749,46.3196729 L32.1341457,46.3196729 Z M32.1341457,46.3196729" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
	<path d="M59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C23.6102502,60 17.9824147,58.1525134 13.2970341,54.9827754 L47.1572554,5.81941103 C54.4691534,11.2806503 59.2139676,20.0777973 59.2139676,30 Z M59.2139676,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>

<a href="http://github.com/sighingnow"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.336871032,30 C0.336871032,13.4314567 13.5672313,0 29.8877097,0 C46.208188,0 59.4385483,13.4314567 59.4385483,30 C59.4385483,46.5685433 46.208188,60 29.8877097,60 C13.5672313,60 0.336871032,46.5685433 0.336871032,30 Z M0.336871032,30" id="Github" fill="#333333" sketch:type="MSShapeGroup"></path>
    <path d="M18.2184245,31.9355566 C19.6068506,34.4507902 22.2845295,36.0156764 26.8007287,36.4485173 C26.1561023,36.9365335 25.3817877,37.8630984 25.2749857,38.9342607 C24.4644348,39.4574749 22.8347506,39.62966 21.5674303,39.2310659 C19.7918469,38.6717023 19.1119377,35.1642642 16.4533306,35.6636959 C15.8773626,35.772144 15.9917933,36.1507609 16.489567,36.4722998 C17.3001179,36.9955141 18.0629894,37.6500075 18.6513541,39.04366 C19.1033554,40.113871 20.0531304,42.0259813 23.0569369,42.0259813 C24.2489236,42.0259813 25.0842679,41.8832865 25.0842679,41.8832865 C25.0842679,41.8832865 25.107154,44.6144649 25.107154,45.6761142 C25.107154,46.9004355 23.4507693,47.2457569 23.4507693,47.8346108 C23.4507693,48.067679 23.9990832,48.0895588 24.4396415,48.0895588 C25.3102685,48.0895588 27.1220883,47.3646693 27.1220883,46.0918317 C27.1220883,45.0806012 27.1382993,41.6806599 27.1382993,41.0860982 C27.1382993,39.785673 27.8372803,39.3737607 27.8372803,39.3737607 C27.8372803,39.3737607 27.924057,46.3153869 27.6704022,47.2457569 C27.3728823,48.3397504 26.8360115,48.1846887 26.8360115,48.6727049 C26.8360115,49.3985458 29.0168704,48.8505978 29.7396911,47.2571725 C30.2984945,46.0166791 30.0543756,39.2072834 30.0543756,39.2072834 L30.650369,39.1949165 C30.650369,39.1949165 30.6837446,42.3123222 30.6637192,43.7373675 C30.6427402,45.2128317 30.5426134,47.0792797 31.4208692,47.9592309 C31.9977907,48.5376205 33.868733,49.5526562 33.868733,48.62514 C33.868733,48.0857536 32.8436245,47.6424485 32.8436245,46.1831564 L32.8436245,39.4688905 C33.6618042,39.4688905 33.5387911,41.6768547 33.5387911,41.6768547 L33.5988673,45.7788544 C33.5988673,45.7788544 33.4186389,47.2733446 35.2190156,47.8992991 C35.8541061,48.1209517 37.2139245,48.1808835 37.277815,47.8089257 C37.3417055,47.4360167 35.6405021,46.8814096 35.6252446,45.7236791 C35.6157088,45.0178155 35.6567131,44.6059032 35.6567131,41.5379651 C35.6567131,38.470027 35.2438089,37.336079 33.8048426,36.4323453 C38.2457082,35.9766732 40.9939527,34.880682 42.3337458,31.9450695 C42.4383619,31.9484966 42.8791491,30.5737742 42.8219835,30.5742482 C43.1223642,29.4659853 43.2844744,28.1550957 43.3168964,26.6025764 C43.3092677,22.3930799 41.2895654,20.9042975 40.9014546,20.205093 C41.4736082,17.0182425 40.8060956,15.5675121 40.4961791,15.0699829 C39.3518719,14.6637784 36.5149435,16.1145088 34.9653608,17.1371548 C32.438349,16.3998984 27.0982486,16.4712458 25.0957109,17.3274146 C21.4005522,14.6875608 19.445694,15.0918628 19.445694,15.0918628 C19.445694,15.0918628 18.1821881,17.351197 19.1119377,20.6569598 C17.8961113,22.2028201 16.9902014,23.2968136 16.9902014,26.1963718 C16.9902014,27.8297516 17.1828264,29.2918976 17.6176632,30.5685404 C17.5643577,30.5684093 18.2008493,31.9359777 18.2184245,31.9355566 Z M18.2184245,31.9355566" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M59.4385483,30 C59.4385483,46.5685433 46.208188,60 29.8877097,60 C23.8348308,60 18.2069954,58.1525134 13.5216148,54.9827754 L47.3818361,5.81941103 C54.6937341,11.2806503 59.4385483,20.0777973 59.4385483,30 Z M59.4385483,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>

<a href="http://linkedin.com/in/pub/%E6%B6%9B-%E4%BD%95/bb/868/732"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.449161376,30 C0.449161376,13.4314567 13.6795217,0 30,0 C46.3204783,0 59.5508386,13.4314567 59.5508386,30 C59.5508386,46.5685433 46.3204783,60 30,60 C13.6795217,60 0.449161376,46.5685433 0.449161376,30 Z M0.449161376,30" fill="#007BB6" sketch:type="MSShapeGroup"></path>
    <path d="M22.4680392,23.7098144 L15.7808366,23.7098144 L15.7808366,44.1369537 L22.4680392,44.1369537 L22.4680392,23.7098144 Z M22.4680392,23.7098144" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M22.9084753,17.3908761 C22.8650727,15.3880081 21.4562917,13.862504 19.1686418,13.862504 C16.8809918,13.862504 15.3854057,15.3880081 15.3854057,17.3908761 C15.3854057,19.3522579 16.836788,20.9216886 19.0818366,20.9216886 L19.1245714,20.9216886 C21.4562917,20.9216886 22.9084753,19.3522579 22.9084753,17.3908761 Z M22.9084753,17.3908761" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M46.5846502,32.4246563 C46.5846502,26.1503226 43.2856534,23.2301456 38.8851658,23.2301456 C35.3347011,23.2301456 33.7450983,25.2128128 32.8575489,26.6036896 L32.8575489,23.7103567 L26.1695449,23.7103567 C26.2576856,25.6271338 26.1695449,44.137496 26.1695449,44.137496 L32.8575489,44.137496 L32.8575489,32.7292961 C32.8575489,32.1187963 32.9009514,31.5097877 33.0777669,31.0726898 C33.5610713,29.8530458 34.6614937,28.5902885 36.5089747,28.5902885 C38.9297703,28.5902885 39.8974476,30.4634101 39.8974476,33.2084226 L39.8974476,44.1369537 L46.5843832,44.1369537 L46.5846502,32.4246563 Z M46.5846502,32.4246563" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M59.5508386,30 C59.5508386,46.5685433 46.3204783,60 30,60 C23.9471212,60 18.3192858,58.1525134 13.6339051,54.9827754 L47.4941264,5.81941103 C54.8060245,11.2806503 59.5508386,20.0777973 59.5508386,30 Z M59.5508386,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>
<a href="http://pinterest.com/sighingnow"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.883833675,30 C0.883833675,13.4314567 13.9008011,0 29.9580459,0 C46.0152907,0 59.0322581,13.4314567 59.0322581,30 C59.0322581,46.5685433 46.0152907,60 29.9580459,60 C13.9008011,60 0.883833675,46.5685433 0.883833675,30 Z M0.883833675,30" fill="#CB2027" sketch:type="MSShapeGroup"></path>
    <path d="M17.5869165,25.6564894 C17.5869165,28.9590618 18.7986851,31.8971698 21.3976941,32.9920559 C21.8238696,33.1718356 22.2056087,32.9982405 22.3292037,32.5113638 C22.4151829,32.1744101 22.6185566,31.3243485 22.7092894,30.9703339 C22.8339179,30.4887888 22.7855546,30.3198854 22.441638,29.9001862 C21.692214,28.9880654 21.213335,27.8072348 21.213335,26.1346224 C21.213335,21.2820631 24.7318662,16.93792 30.3754877,16.93792 C35.3728188,16.93792 38.1183644,20.08865 38.1183644,24.2965188 C38.1183644,29.8330087 35.7438106,34.5057882 32.2186656,34.5057882 C30.2719407,34.5057882 28.8146355,32.8444787 29.2817337,30.8069754 C29.8410115,28.3745112 30.9244314,25.7492583 30.9244314,23.9934738 C30.9244314,22.4217342 30.1068028,21.1108139 28.4147084,21.1108139 C26.4245806,21.1108139 24.8259058,23.2351148 24.8259058,26.0808804 C24.8259058,27.8933925 25.4194926,29.1192214 25.4194926,29.1192214 C25.4194926,29.1192214 23.3828616,38.0231153 23.0259242,39.5824856 C22.3149428,42.6880041 22.9190703,46.4949407 22.9701204,46.8794518 C23.0000891,47.1072154 23.2838616,47.1613839 23.412417,46.9892816 C23.5959494,46.7421112 25.9661629,43.7227504 26.7720107,40.7057356 C26.9999795,39.8514088 28.0809192,35.427719 28.0809192,35.427719 C28.7274162,36.7002523 30.6170973,37.8211564 32.6266532,37.8211564 C38.6088176,37.8211564 42.6674052,32.1938169 42.6674052,24.6614098 C42.6674052,18.9658266 37.9920825,13.6613656 30.8861955,13.6613656 C22.0448112,13.6613656 17.5869165,20.2021053 17.5869165,25.6564894 Z M17.5869165,25.6564894" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M59.0322581,30 C59.0322581,46.5685433 46.0152907,60 29.9580459,60 C24.0027941,60 18.4657302,58.1525134 13.8559203,54.9827754 L47.170009,5.81941103 C54.3639732,11.2806503 59.0322581,20.0777973 59.0322581,30 Z M59.0322581,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>
<a href="/feed.xml"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.112290344,30 C0.112290344,13.4314567 13.3426506,0 29.663129,0 C45.9836073,0 59.2139676,13.4314567 59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C13.3426506,60 0.112290344,46.5685433 0.112290344,30 Z M0.112290344,30" fill="#E18F00" sketch:type="MSShapeGroup"></path>
    <path d="M26.5147755,38.7571296 C26.5147755,36.8192934 24.9575021,35.2291656 23.0297047,35.2291656 C21.1094331,35.2291656 19.5492775,36.8192934 19.5492775,38.7571296 C19.5492775,40.7052068 21.1094331,42.277616 23.0297047,42.277616 C24.957422,42.277616 26.5146954,40.7052881 26.5147755,38.7571296 Z M36.8075433,42.2700571 C36.8075433,32.6055847 29.062648,24.7442705 19.5492775,24.7442705 L19.5492775,29.8318017 C22.8128986,29.8318017 25.8817303,31.1272145 28.1920609,33.4740429 C30.4999895,35.8159133 31.7732853,38.9454513 31.7732853,42.2701384 L36.8075433,42.2700571 Z M45.6871482,42.2675375 C45.6871482,27.6346878 33.9604014,15.722384 19.5492775,15.722384 L19.5492775,20.8123535 C31.186916,20.8123535 40.660496,30.438869 40.660496,42.2673749 L45.6871482,42.2675375 Z M45.6871482,42.2675375" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C23.6102502,60 17.9824147,58.1525134 13.2970341,54.9827754 L47.1572554,5.81941103 C54.4691534,11.2806503 59.2139676,20.0777973 59.2139676,30 Z M59.2139676,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>
<a href="http://twitter.com/sighingnow"><svg width="40px" height="40px" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0,30 C0,13.4314567 13.4508663,0 30.0433526,0 C46.6358389,0 60.0867052,13.4314567 60.0867052,30 C60.0867052,46.5685433 46.6358389,60 30.0433526,60 C13.4508663,60 0,46.5685433 0,30 Z M0,30" fill="#4099FF" sketch:type="MSShapeGroup"></path>
    <path d="M29.2997675,23.8879776 L29.3627206,24.9260453 L28.3135016,24.798935 C24.4943445,24.3116787 21.1578281,22.6592444 18.3249368,19.8840023 L16.9399677,18.5069737 L16.5832333,19.5238563 C15.8277956,21.7906572 16.3104363,24.1845684 17.8842648,25.7946325 C18.72364,26.6844048 18.5347806,26.8115152 17.0868584,26.2818888 C16.5832333,26.1124083 16.1425613,25.985298 16.1005925,26.0488532 C15.9537019,26.1971486 16.457327,28.1249885 16.8560302,28.8876505 C17.4016241,29.9469033 18.5137962,30.9849709 19.7308902,31.5993375 L20.7591248,32.0865938 L19.5420308,32.1077788 C18.3669055,32.1077788 18.3249368,32.1289639 18.4508431,32.57385 C18.8705307,33.9508786 20.5282967,35.4126474 22.3749221,36.048199 L23.6759536,36.4930852 L22.5427971,37.1710069 C20.8640467,38.1455194 18.891515,38.6963309 16.9189833,38.738701 C15.9746862,38.759886 15.1982642,38.8446262 15.1982642,38.9081814 C15.1982642,39.1200319 17.7583585,40.306395 19.2482495,40.7724662 C23.7179224,42.1494948 29.0269705,41.5563132 33.0140027,39.2047722 C35.846894,37.5311528 38.6797853,34.2050993 40.0018012,30.9849709 C40.7152701,29.2689815 41.428739,26.1335934 41.428739,24.6294545 C41.428739,23.654942 41.4916922,23.5278317 42.6668174,22.3626537 C43.359302,21.6847319 44.0098178,20.943255 44.135724,20.7314044 C44.3455678,20.3288884 44.3245835,20.3288884 43.2543801,20.6890343 C41.4707078,21.324586 41.2188952,21.2398458 42.1002392,20.2865183 C42.750755,19.6085965 43.527177,18.3798634 43.527177,18.0197174 C43.527177,17.9561623 43.2124113,18.0620876 42.8556769,18.252753 C42.477958,18.4646036 41.6385828,18.7823794 41.0090514,18.9730449 L39.8758949,19.3331908 L38.8476603,18.634084 C38.281082,18.252753 37.4836756,17.829052 37.063988,17.7019416 C35.9937846,17.4053509 34.357003,17.447721 33.3917215,17.7866818 C30.768674,18.7400093 29.110908,21.1974757 29.2997675,23.8879776 Z M29.2997675,23.8879776" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
    <path d="M60.0867052,30 C60.0867052,46.5685433 46.6358389,60 30.0433526,60 C23.8895925,60 18.1679598,58.1525134 13.4044895,54.9827754 L47.8290478,5.81941103 C55.2628108,11.2806503 60.0867052,20.0777973 60.0867052,30 Z M60.0867052,30" id="reflec" fill-opacity="0.08" fill="#000000" sketch:type="MSShapeGroup"></path>
</svg></a>
<a href="https://plus.google.com/102570111351055130345"><svg width="40" height="40" xmlns="http://www.w3.org/2000/svg">

 <g>
  <title>background</title>
  <rect fill="none" id="canvas_background" height="42" width="42" y="-1" x="-1"/>
 </g>
 <g>
  <title>Google+</title>
  <g stroke="null" id="svg_1">
   <circle stroke="null" id="svg_2" r="20" fill-rule="evenodd" fill="#E02F2F" cy="20" cx="20" clip-rule="evenodd"/>
   <g stroke="null" id="svg_3">
    <path stroke="null" id="svg_4" fill="#FFFFFF" d="m23.9375,7.4975c0,0 -6.027,0 -8.09025,0c-3.70125,0 -7.18594,2.47375 -7.18594,5.56625c0,3.16 2.52262,5.6175 6.28819,5.6175c0.2625,0 0.51712,-0.05625 0.7665,-0.07375c-0.24675,0.44375 -0.41737,0.92125 -0.41737,1.4425c0,0.87875 0.49481,1.58 1.12087,2.16125c-0.46988,0 -0.93056,0.00625 -1.43062,0.00625c-4.58456,0.00125 -8.11388,2.78 -8.11388,5.66375c0,2.84 3.86925,4.61875 8.45381,4.61875c5.22769,0 8.11519,-2.8275 8.11519,-5.6675c0,-2.27625 -0.70613,-3.64125 -2.88619,-5.11375c-0.74681,-0.50125 -2.1735,-1.725 -2.1735,-2.445c0,-0.8425 0.252,-1.2575 1.5855,-2.25c1.36369,-1.015 2.331,-2.22625 2.331,-3.88875c0,-1.97625 -0.8925,-4.3875 -2.62894,-4.3875l2.95313,0l1.3125,-1.25zm-2.71556,18.8425c0.063,0.265 0.10106,0.53625 0.10106,0.81125c0,2.295 -1.55531,4.08875 -6.01125,4.08875c-3.16969,0 -5.45737,-1.91 -5.45737,-4.205c0,-2.24875 2.83894,-4.1225 6.00994,-4.08875c0.73763,0.0075 1.428,0.12125 2.05275,0.31125c1.72069,1.14125 2.95444,1.785 3.30487,3.0825zm-5.07675,-8.56125c-2.12756,-0.05875 -4.15012,-2.26625 -4.51631,-4.925c-0.36619,-2.6625 1.0605,-4.69875 3.18675,-4.63875c2.12625,0.0625 4.15012,2.1975 4.51631,4.8575c0.3675,2.66 -1.05919,4.76625 -3.18675,4.70625z"/>
    <polygon stroke="null" id="svg_5" points="30.5,17.488750457763672 30.5,13.738750457763672 27.875,13.738750457763672 27.875,17.488750457763672 23.9375,17.488750457763672 23.9375,19.988750457763672 27.875,19.988750457763672 27.875,23.73874855041504 30.5,23.73874855041504 30.5,19.988750457763672 34.4375,19.988750457763672 34.4375,17.488750457763672 " fill="#FFFFFF"/>
   </g>
  </g>
  <g id="svg_6"/>
  <g id="svg_7"/>
  <g id="svg_8"/>
  <g id="svg_9"/>
  <g id="svg_10"/>
  <g id="svg_11"/>
 </g>
</svg></a>
<a href="http://stackoverflow.com/users/5080177/he-tao"><svg width="40" height="40" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
  <path fill="#919191" d="m7.294075,23.110188l2.385864,0.023237l-0.083177,10.552679l15.878221,0l0,-10.514505l2.51405,0l0,13.07741l-20.707843,0l0.01289,-13.138815l-0.000005,-0.000006z"/>
  <rect fill="#919191" y="29.348862" x="11.184582" height="2.628626" width="12.437938"/>
  <rect fill="#a78b68" transform="matrix(0.5395733410304717,0.05172669848399204,-0.05207586478003252,0.5359555264108665,3.6611416648678325,1.4067255727666614) " y="41.524347" x="18.49125" height="5.003923" width="23.066864"/>
  <rect fill="#c19653" transform="matrix(0.5216998676238958,0.14625586092278992,-0.1472431193160242,0.5182018938275416,3.6611416648678325,1.4067255727666614) " y="27.438515" x="24.907076" height="5.003923" width="23.066864"/>
  <rect fill="#d48c28" transform="matrix(0.4640090244261216,0.2783830739288475,-0.2802622193151353,0.46089786509976993,3.6611416648678325,1.4067255727666614) " y="7.461092" x="30.089396" height="5.003923" width="23.066864"/>
  <rect fill="#fe8908" transform="matrix(0.3157222700143304,0.4376935608999602,-0.4406480862019664,0.31360536660688737,3.6611416648678325,1.4067255727666614) " y="-20.343803" x="28.488303" height="5.003923" width="23.066864"/>
  <rect fill="#ff7a15" transform="matrix(0.0893402304821676,0.5310828333843179,-0.5346677562821299,0.08874120831524585,3.6611416648678325,1.4067255727666614) " y="-47.045927" x="14.158203" height="5.003923" width="23.066864"/>
</svg>
</a>
</div>
            
            &copy; 2016 - Sighingnow. All rights reserved.<br/>
            Built using 
            
            <a href="http://jekyllrb.com/">Jekyll</a>
             and Theme proudly powered by <a href="https://github.com/olakara/JekyllMetro">JekyllMetro.</a> 
      </div>
</footer>


      <!-- Mathjax config template. -->

<style type="text/css">
  span.MathJax_SVG { zoom : 1.0; }
</style>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
          processEscapes: true
        },
        // displayAlign: "left",
        // displayIndent: "0em",
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.body]);
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG" type="text/javascript"></script>



    
    </div> <!-- content area column -->
  </div> <!-- row  -->
</div> <!-- container -->
      
      
      
	  

    <!-- <script>
(function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

ga('create', '', 'blog-olakara.rhcloud.com');
ga('send', 'pageview');
</script>
 -->
    <a href="#" class="scrollToTop"></a>
	<script type="text/javascript">
    $(document).ready(function(){
    
    //Check to see if the window is top if not then display button
    $(window).scroll(function(){
        if ($(this).scrollTop() > 100) {
            $('.scrollToTop').fadeIn();
        } else {
            $('.scrollToTop').fadeOut();
        }
    });
    
    //Click event to scroll to top
    $('.scrollToTop').click(function(){
        $('html, body').animate({scrollTop : 0},800);
        return false;
    });
    
});
</script>
  </body>
</html>

