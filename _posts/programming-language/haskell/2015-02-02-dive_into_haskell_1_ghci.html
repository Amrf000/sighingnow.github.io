---
title: Dive Into Haskell(1) GHCi
author: He Tao
date: 2015-02-02
tags: [Haskell]
category: 编程语言
layout: post
---

<h2 id="whats-ghc">What’s GHC ?</h2>
<p>GHC(Glasgow Haskell Compiler): an interactive and batch compilation system for the <a href="http://www.haskell.org/" title="Haskell">Haskell 98</a> language.</p>
<p>GHC has two main components: an interactive Haskell interpreter (also known as GHCi), and a batch compiler, described throughout. In fact, GHC consists of a single program which is just run with different options to provide either the interactive or the batch system.</p>
<h2 id="whats-ghci">What’s GHCi ?</h2>
<p>GHCi是一个GHC的交互式环境，在GHCi中可以交互式地求得对Haskell表达式的值，Haskell程序也可以在GHCi中被解释。GCHi还包含了一个交互式的Haskell调试器。</p>
<h2 id="ghci的常用命令">GHCi的常用命令：</h2>
<!--more-->
<ul>
<li>:? 或 :help 获取关于GHCi的帮助。</li>
<li>:q 或 :quit 退出GHCi。</li>
<li>:!<cmd> 执行外部命令<cmd>。</li>
<li>:l 和 :r 或 :load 和 :reload 加载外部的hs文件。</li>
<li>:t 或 :type 显示出表达式的类型。</li>
<li>:set + t 设置所有表达式默认显示出其类型。</li>
<li>:i<name> 显示<name>相关的信息(info)。可以通过这种方式获取帮助。例如：</li>
</ul>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="fu">:</span>i print
print<span class="ot"> ::</span> <span class="dt">Show</span> a <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">IO</span>() <span class="co">-- Defined in &#39;System.IO&#39;</span>
<span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="fu">:</span>i <span class="fu">+</span>
<span class="kw">class</span> <span class="dt">Num</span> a <span class="kw">where</span>
<span class="ot">  (+) ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a
  <span class="fu">...</span>
        <span class="co">-- Defined in &#39;CHC.Num&#39;</span></code></pre>
<h2 id="ghci-使用">GHCi 使用</h2>
<p>在GHCi的使用中，应该注意以下几点：</p>
<ul>
<li>GHCi 中可以直接进行数学表示式的运算，在这一点上和Python的交互式环境(Python Shell) 很像。</li>
<li><p>GHCi 中支持的数学运算符号：+, -, *, /, **(乘方)。<strong>注意</strong>：**计算得到的结果是浮点数：</p>
<pre><code>Prelude&gt; :t 2 ** 2
2 ** 100 :: Floating a-&gt;a</code></pre></li>
<li>Haskell中不同类型的数不能直接进行数学运算。需要做类型转换。
<ul>
<li><code>fromIntegral</code>函数可以将整数类型转换为别的类型。</li>
<li><code>toIntegral</code>函数可以将其他类型的数(如：浮点数)转换成整数。</li>
<li>类似的函数还有：<code>fromInteger</code>,<code>toInteger</code>。</li>
</ul></li>
<li>GHCi 中不能用 % 进行取模运算。</li>
<li><p>GHCi 中，用<code>/=</code>表达不等号。举例：</p>
<pre><code>Prelude&gt; 10 /= 20
True
Prelude&gt; 10 /= 10
False</code></pre></li>
<li><p>GHCi 有一个名为 <code>it</code> 的变量，自动保存上一次计算的结果。其类型也随上一条表达式的结果的变化而变化。</p></li>
</ul>
<h2 id="ghci交互式环境与加载hs文件的区别">GHCi交互式环境与加载hs文件的区别</h2>
<p>如果加载一个hs文件，GHCi会将整个文件看作一个过程，其解释顺序是不可预测的。<strong>但是</strong>，在GHCi中直接输入表达式是，其解释顺序是由输入(IO)的顺序的决定的。例如：</p>
<pre><code>c = a + b
a = 1
b = 2</code></pre>
<p>将这段代码写在hs文件中，在load进GHCi中后，执行<code>c</code>可以正常输出<code>3</code>，但在GHCi中，无法通过直接输入表达式来得到这样的结果。这也是Haskell的函数式的特性所决定的。</p>
<h2 id="ghci-与函数">GHCi 与函数</h2>
<p>在GHCi中输入加减乘除等表达式时都是在调用函数，<code>+, -, *, /</code> 等都是函数。因此，有如下的用法：</p>
<pre><code>Prelude&gt; (+) 1 2
3</code></pre>
<p>除此以外，还有这些函数可以使用：</p>
<ul>
<li><p><code>succ</code> 函数</p>
<pre><code>Prelude&gt; succ 1
2
Prelude&gt; succ &#39;a&#39;
&#39;b&#39;</code></pre></li>
<li><p><code>max</code> 和 <code>min</code> 函数</p></li>
</ul>
<p>前面提到的<code>/</code>表示的真除法(和Python类似)，如果只想保留结果的整数部分(和C++类似)，那么可以使用<code>div</code>函数:</p>
<pre><code>Prelude&gt; div 10 3
3</code></pre>
<p>显然，这种形式并不便于理解和区分除数和被除数，因此，可以写成中缀函数的形式(<strong>注意</strong> <code>div</code> 左右各有一个<strong>“`”</strong>符号)：</p>
<pre><code>Prelude&gt; 10 `div` 3
3</code></pre>
<p>前面提到，在GHCi中，不能用 <code>%</code> 来表示取模运算，可以这样实现取模:</p>
<pre><code>Prelude&gt; mod 10 3
1
Prelude&gt; 10 `mod` 3
1</code></pre>
<h2 id="ghci-中定义变量">GHCi 中定义变量</h2>
<p>在GHCi中使用<code>let</code>来定义变量：</p>
<pre><code>Prelude&gt; let a = 1
Prelude&gt; a
1</code></pre>
<p>在GHCi中用<code>let</code>定义变量与在hs文件中通过用<code>=</code>赋值来定义变量是等价的。例如：</p>
<pre><code>a = 1</code></pre>
<p>在GHCi中，如果直接使用<code>=</code>对变量赋值会出错。</p>
<h2 id="ghci-自动补全">GHCi 自动补全</h2>
<p>在GHCi中输入命令时，输入命令的前几个字符后，按<code>Tab</code>键便可以补全命令。如果有多个相匹配的命令，GHCi会在下一行列出这些命令。如果只有一个，会直接补全。</p>
