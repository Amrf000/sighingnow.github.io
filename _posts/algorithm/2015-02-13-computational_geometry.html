---
title: 计算几何算法
author: He Tao
date: 2015-02-13
tag: Algorithm
category: Algorithm
layout: post
---

<h2 id="矢量叉积">1. 矢量叉积</h2>
<p>设矢量P(x1, y1), Q(x2, y2)，如果：</p>
<pre><code>1. P x Q &gt; 0 : 则P在Q的顺时针方向;
2. P x Q &lt; 0 : 则P在Q的逆时针方向;
3. P x Q = 0 : 则P与Q共线，但可能同向或也可能反向。</code></pre>
<h2 id="向量拐向判断">2. 向量拐向判断</h2>
<p>已知线段PQ和QR，记 ans = (R-P) x (Q-P)，有如下结论：</p>
<pre><code>1. ans &gt; 0: PQ在Q点向右侧拐后得到QR；
2. ans &lt; 0：PQ在Q点向左侧拐后得到QR；
3. ans = 0: P、Q、R 三点共线。</code></pre>
<!--more-->
<h2 id="判断点在线段上">3. 判断点在线段上</h2>
<p>首先判断点是否在线段所在的直线上，然后判断点的坐标是否在线段的坐标范围内。</p>
<pre><code>ON-SEGMENT(P, Q, R)
    if (R-P) x (Q-P) == 0 and min(px, qx) &lt;= rx &lt;= max(px, qx)
        return True
    else
        return False</code></pre>
<h2 id="判断线段相交">4. 判断线段相交</h2>
<p>如果两线段相交，那么每条线段的两个端点都在另一条线段的两侧（不考虑端点在另一条线段上的情形）。由上文中的判断向量拐向的方法，不难得出判断线段相交的方法如下：</p>
<ol style="list-style-type: decimal">
<li>首先，判断每条线段的端点是否在另一条线段上，如果存在这种情况，则相交，交点为该端点。</li>
<li><p>然后，分别判断每条线段的两个端点是否在另外一条线段的两侧，如果是，则相交。</p></li>
<li><h2 id="判断线段和直线相交">判断线段和直线相交</h2></li>
</ol>
<p>线段和直线相交于两条线段类似，只不过要求更加宽松。</p>
<ol style="list-style-type: decimal">
<li>首先判断线段的两个端点是否在直线上，如果是，则相交，该端点为交点。</li>
<li>然后，判断线段的两个端点是否在直线的两侧（计算时直接从直线上任取一向量即可），如果是，则相交。</li>
</ol>
<p>该算法可以总结为如下的公式：</p>
<p>如果线段PQ和直线MN相交，那么有：</p>
<pre><code>(P-M)x(N-M) * (N-M)(Q-M) &gt;= 0</code></pre>
<h2 id="点在多边形内">6. 点在多边形内</h2>
<h3 id="点与多边形的关系">点与多边形的关系</h3>
<p>点与多边形的关系有三种：</p>
<ol style="list-style-type: decimal">
<li>点在多边形内</li>
<li>点在多边形外</li>
<li>点在多边形上</li>
</ol>
<p>此处主要总结如何判断点在多边形内/外。判断点与多边形的关系，有如下两种方法：</p>
<h3 id="射线法">射线法</h3>
<p>从点出发，取定某一方向（通常取X轴正方向）做射线，如果该射线与多边形相交奇数次，则在多边形内，相交偶数次，则在多边形外。</p>
<p>为判断相交次数，可以判断多边形的每一条边与线段（P,INF）（INF为一个大正整数）相交的次数。时间复杂度为O(N)。</p>
<p>同时，还需要考虑如下两种特殊情况：</p>
<p>射线可能会与多边形的某一条边重合，对于这种情况，如果取定X轴正方向为射线方向，在判断时直接忽略多边形的水平边即可。</p>
<p>射线还可能与多边形的某一顶点重合，对于这种情况，判断于该定点相连的两条边的另两个端点是否在射线两侧，如果是，则算一次相交，否则忽略。</p>
<h2 id="判断线段是否在多边形内">7. 判断线段是否在多边形内</h2>
<p>首先判断线段的两个端点是否在多边形内，然后判断线段是否与多边形的每条边都不相交。</p>
<h2 id="求点到线段的最近点">8. 求点到线段的最近点</h2>
<p>首先，从点出发向线段所在的直线做垂线，如果垂足在线段上，则返回垂足，否则返回距离垂足最近的端点。</p>
