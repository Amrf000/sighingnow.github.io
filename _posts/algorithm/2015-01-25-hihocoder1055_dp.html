---
title: HihoCoder 1055 题解
author: He Tao
date: 2015-01-25
tag: Algorithm
category: Algorithm
layout: post
---

<h2 id="一题目大意">一、题目大意</h2>
<p>树上每个点都有一个权值，找出与根节点连通的m个点，使得这m个点的权值之和最大。</p>
<p>题目链接: <a href="http://hihocoder.com/problemset/problem/1055">HihoCoder 1055 刷油漆</a></p>
<h2 id="二分析">二、分析</h2>
<h3 id="基本思路">基本思路</h3>
<p>树上的动态规划。</p>
<!--more-->
<h3 id="具体解法">具体解法</h3>
<p>设<code>f[t][m]</code>表示以t为根节点，包括t节点在内的m个节点的权值总和的最大值，那么题目要求的便是<code>f[1][m]</code>的值。</p>
<p>假设t节点有孩子节点tc, 那么以tc为跟又可以构成一棵子树，并且在该子树上最多取m-1个节点，对于<code>f[t][m]</code>来说，有如下的状态转移方程:</p>
<p><span class="math">\[ f[t][m] = max\{f[t][m], f[t][m-m_tc]+f[tc][m_tc]\} \]</span></p>
<p>其中，<code>m_tc</code>的取值范围为</p>
<p><span class="math">\[ 1, 2, 3, ..., m-1 \]</span></p>
<p>m的取值范围为</p>
<p><span class="math">\[ m, m-1, m-2, ..., 2 \]</span></p>
<p>由此，对整棵树进行一次后序遍历，每遍历玩一个根节点，便对该根节点做一次dp，由此，便可以得到<code>f[1][m]</code>的值。</p>
<h2 id="三代码">三、代码</h2>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;iostream&gt;</span>
<span class="ot">#include &lt;cstdio&gt;</span>
<span class="ot">#include &lt;algorithm&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> std;

<span class="co">/**</span>
 * Author: DHDave (buaahetao<span class="er">@</span>gmai.com), SCSE, BUAA.
 */

<span class="dt">const</span> <span class="dt">int</span> max_n = <span class="dv">110</span>;
<span class="dt">int</span> v[max_n] = {<span class="dv">0</span>};
<span class="dt">int</span> graph[max_n][max_n];
<span class="dt">int</span> f[max_n][max_n]; <span class="co">// f[t][j]以t为根的包括t在内的j个节点的得分</span>
<span class="dt">int</span> n, m;

<span class="dt">void</span> dp(<span class="dt">int</span> pos, <span class="dt">int</span> father) {
    f[pos][<span class="dv">1</span>] = v[pos];
    <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {
        <span class="kw">if</span>(i != father &amp;&amp; graph[pos][i] == <span class="dv">1</span>) {
            <span class="kw">for</span>(<span class="dt">int</span> mm = m; mm &gt;= <span class="dv">2</span>; --mm) {
                <span class="kw">for</span>(<span class="dt">int</span> m_tc = <span class="dv">1</span>; m_tc &lt; mm; m_tc++) {
                    f[pos][mm] = max(f[pos][mm], 
                            f[pos][mm-m_tc] + f[i][m_tc]);
                }
            }
        }
    }
}

<span class="dt">void</span> post_order(<span class="dt">int</span> pos, <span class="dt">int</span> father) {
    <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {
        <span class="kw">if</span>(i != father &amp;&amp; graph[pos][i] == <span class="dv">1</span>) {
            post_order(i, pos);
        }
    }
    dp(pos, father);
}

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
    scanf(<span class="st">&quot;</span><span class="ch">%d</span><span class="st"> </span><span class="ch">%d</span><span class="st">&quot;</span><span class="co">,</span> &amp;n, &amp;m);
    <span class="dt">int</span> x, y;
    <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {
        scanf(<span class="st">&quot;</span><span class="ch">%d</span><span class="st">&quot;</span><span class="co">,</span> v+i);
    }
    <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; n; ++i) {
        scanf(<span class="st">&quot;</span><span class="ch">%d</span><span class="st"> </span><span class="ch">%d</span><span class="st">&quot;</span><span class="co">,</span> &amp;x, &amp;y);
        graph[x][y] = graph[y][x] = <span class="dv">1</span>;
    }
    post_order(<span class="dv">1</span>, <span class="dv">-1</span>);
    printf(<span class="st">&quot;</span><span class="ch">%d\n</span><span class="st">&quot;</span><span class="co">,</span> f[<span class="dv">1</span>][m]);
    <span class="kw">return</span> <span class="dv">0</span>;
}

<span class="co">/* vim: set ts=4, sw = 4 */</span></code></pre>
