---
title: K-近邻算法(KNN)
author: He Tao
date: 2015-02-08
tag: [机器学习]
category: 机器学习
layout: post
---

<p>K-近邻算法(KNN, K Nearest Neighbors)是最基本、最简单、最有效的分类算法之一。KNN算法精度高、对异常值不敏感，可以有效地处理数据缺失的情况，但同时，KNN算法的计算时间复杂度和空间复杂度都很高，特别是运行时需要载入全部数据，会占用很大的内存空间。</p>
<p>KNN算法的基本原理：输入未分类的（没有标签的）新数据时，将新数据的每个特征与样本集中的数据所对应的特征进行比较，然后提取出最相似的分类，作为新数据的分类。一般来说，选取样本集中最相似的前<span class="math">\(k\)</span>个元素作为分类标准。通常来说，<span class="math">\(k\)</span>的值不大于20，选择这<span class="math">\(k\)</span>个最相似元素中出现次数最多的分类作为新数据的分类。</p>
<!--more-->
<h2 id="knn算法的一般步骤">kNN算法的一般步骤</h2>
<ul>
<li><p>准备数据</p>
<p>导入数据集，格式化数据。在这个过程中，有时需要补全数据缺失项和做规格化数据的预处理。</p></li>
<li><p>分析数据</p>
<p>通过图标、相关性分析等方法选择出数据集与分类相关的特征值，将其作为KNN分类的基础。</p></li>
<li><p>计算距离，分类</p>
<p>通过与样本集比较，对测试集分类，有时，也可以用作预测。</p></li>
</ul>
<h2 id="准备数据">准备数据</h2>
<p>很多时候，数据的某些特征与分类无关，如果将这些特征应用于KNN算法，可能会影响到分类的准确性，因此，需要先对数据进行分析，去除无关特征。</p>
<p>如下例所示，通过散点图的方法，不难看出以下样本集中，不同特征对分类的影响是不同的。</p>
<div class="figure">
<img src="{{%20site.url%20}}/resource/k_nearest_neighbors/knn-dating-1.png" title="图1" alt="图1" />
<p class="caption">图1</p>
</div>
<div class="figure">
<img src="{{%20site.url%20}}/resource/k_nearest_neighbors/knn-dating-2.png" title="图2" alt="图2" />
<p class="caption">图2</p>
</div>
<div class="figure">
<img src="{{%20site.url%20}}/resource/k_nearest_neighbors/knn-dating-3.png" title="图3" alt="图3" />
<p class="caption">图3</p>
</div>
<p>可见，选取不同的特征作为<code>x</code>，<code>y</code>轴时，数据集中各类的点分布是不同的。在数据分析阶段，除了以上使用的散点图，还可以使用相关性分析等方法进行数据特征分析。</p>
<h2 id="距离的计算">距离的计算</h2>
<p>通常，直接采用特征向量的几何距离作为数据之间的距离。</p>
<p>在计算距离时必须考虑到数据规一化的问题。由于数据的不同特征的值相差太大，如果不做规一化处理，很可能会导致最终距离仅仅能够反映特征向量某一分量的特点。因此，必须根据特征的重要性等来对数据进行规一化预处理。</p>
<p>比如，以下数据集如果不做规格化处理，KNN算法分类的结果会很不准确。</p>
<pre><code>42666   13.276369   0.543880    largeDoses
67497   8.631577    0.749278    didntLike
35483   12.273169   1.508053    largeDoses
50242   3.723498    0.831917    didntLike
63275   8.385879    1.669485    didntLike</code></pre>
<p>一般来说，规一化数据的方法为依据特征值将数据值变换到__0-1<strong>或者</strong>-1-1__之间。可以通过以下公式进行：</p>
<p><span class="math">\[ newVal = \frac{oldVal-min}{max-min} \]</span></p>
<p>此公式可以把数据规格化到__0-1__之间。</p>
<p>在归一化处理时，还可以根据之前的分析，对不同的特征分量加上不同的权重，以提高分类的准确率。</p>
<h2 id="附件">附件</h2>
<ol style="list-style-type: decimal">
<li><a href="{{%20site.url%20}}/resource/k_nearest_neighbors/dating.py">knn-dating</a> 测试用数据：<a href="{{%20site.url%20}}/resource/k_nearest_neighbors/dating.zip">dating.zip</a></li>
<li><a href="{{%20site.url%20}}/resource/k_nearest_neighbors/handwriting.py">KNN 手写数字识别</a> 测试用数据：<a href="{{%20site.url%20}}/resource/k_nearest_neighbors/handwriting.zip">handwriting.zip</a></li>
</ol>
<h2 id="参考">参考</h2>
<ol style="list-style-type: decimal">
<li>机器学习实战(<i>Machine Learning in Action</i>)</li>
</ol>
